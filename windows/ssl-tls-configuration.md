# Windows SSL/TLS Support

## Server
| Windows OS                                            	| SSL 2.0 	| SSL 3.0 	| TLS 1.0 	| TLS 1.1 	| TLS 1.2 	| TLS 1.3 	|
|-------------------------------------------------------	|:-------:	|:-------:	|:-------:	|:-------:	|:-------:	|:-------:	|
| Windows Vista / Windows Server 2008                     	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|    ❌    	|    ❌    	|
| Windows Server 2008 with Service Pack 2 (SP2)         	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 7 / Windows Server 2008 R2                      	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 8 / Windows Server 2012                         	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 8.1 / Windows Server 2012 R2                    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1507                              	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1511                              	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1607 / Windows Server 2016 Standard 	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1703                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1709                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1803                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1809 / Windows Server 2019         	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1903                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1909                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 2004                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 20H2                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 21H1                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows Server 2022                                   	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|

<br>

## Client
| Windows OS                                            	| SSL 2.0 	| SSL 3.0 	| TLS 1.0 	| TLS 1.1 	| TLS 1.2 	| TLS 1.3 	|
|-------------------------------------------------------	|:-------:	|:-------:	|:-------:	|:-------:	|:-------:	|:-------:	|
| Windows Vista / Windows Server 2008                     	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|    ❌    	|    ❌    	|
| Windows Server 2008 with Service Pack 2 (SP2)         	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 7 / Windows Server 2008 R2                      	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 8 / Windows Server 2012                         	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 8.1 / Windows Server 2012 R2                    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1507                              	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1511                              	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1607 / Windows Server 2016 Standard 	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1703                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1709                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1803                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1809 / Windows Server 2019         	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1903                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 1909                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 2004                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 20H2                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows 10, version 21H1                              	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ❌    	|
| Windows Server 2022                                   	|    ❌    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|    ✔    	|

<br>
<br>

# Disabling Vulnerable SSL/TLS Protocols

## Server
| Registry Key                                                                                            	| DWord             	| Value 	|
|---------------------------------------------------------------------------------------------------------	|-------------------	|:-----:	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 2.0\Server 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 2.0\Server 	| DisabledByDefault 	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 3.0\Server 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 3.0\Server 	| DisabledByDefault 	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.0\Server 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.0\Server 	| DisabledByDefault 	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.1\Server 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.1\Server 	| DisabledByDefault 	|   1   	|

<br>

```powershell
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Server' -name 'DisabledByDefault' -value 1 -PropertyType 'DWord' -Force | Out-Null
Write-Host 'SSL 2.0 has been disabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Server' -name 'DisabledByDefault' -value 1 -PropertyType 'DWord' -Force | Out-Null
Write-Host 'SSL 3.0 has been disabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Server' -name 'DisabledByDefault' -value 1 -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.0 has been disabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Server' -name 'DisabledByDefault' -value 1 -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.1 has been disabled.'
```

<br>

## Client
| Registry Key                                                                                            	| DWord             	| Value 	|
|---------------------------------------------------------------------------------------------------------	|-------------------	|:-----:	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 2.0\Client 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 2.0\Client 	| DisabledByDefault 	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 3.0\Client 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\SSL 3.0\Client 	| DisabledByDefault 	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.0\Client 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.0\Client 	| DisabledByDefault 	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.1\Client 	| Enabled           	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.1\Client 	| DisabledByDefault 	|   1   	|

<br>

```powershell
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 2.0\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'SSL 2.0 has been disabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'SSL 3.0 has been disabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.0 has been disabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client' -name 'Enabled' -value '0' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\Client' -name 'DisabledByDefault' -value '1' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.1 has been disabled.'
```

<br>

# Revert Changes

```powershell
Remove-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\SSL 3.0\' -Recurse
Remove-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.0\' -Recurse
Remove-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.1\' -Recurse
```

<br>
<br>

# Enabling Recommended SSL/TLS Protocols

## Server
| Registry Key                                                                                            	| DWord             	| Value 	|
|---------------------------------------------------------------------------------------------------------	|-------------------	|:-----:	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.2\Server 	| Enabled           	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.2\Server 	| DisabledByDefault 	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.3\Server 	| Enabled           	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.3\Server 	| DisabledByDefault 	|   0   	|

<br>

```powershell
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -name 'Enabled' -value '1' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Server' -name 'DisabledByDefault' -value '0' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.2 has been enabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.3\Server' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.3\Server' -name 'Enabled' -value '1' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.3\Server' -name 'DisabledByDefault' -value '0' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.3 has been enabled.'
```

<br>

## Client
| Registry Key                                                                                            	| DWord             	| Value 	|
|---------------------------------------------------------------------------------------------------------	|-------------------	|:-----:	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.2\Client 	| Enabled           	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.2\Client 	| DisabledByDefault 	|   0   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.3\Client 	| Enabled           	|   1   	|
| HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\Schannel\Protocols\TLS 1.3\Client 	| DisabledByDefault 	|   0   	|

<br>

```powershell
New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Client' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Client' -name 'Enabled' -value '1' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.2\Client' -name 'DisabledByDefault' -value '0' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.2 has been enabled.'

New-Item 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.3\Client' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.3\Client' -name 'Enabled' -value '1' -PropertyType 'DWord' -Force | Out-Null
New-ItemProperty -path 'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL\Protocols\TLS 1.3\Client' -name 'DisabledByDefault' -value '0' -PropertyType 'DWord' -Force | Out-Null
Write-Host 'TLS 1.3 has been enabled.'
```

<br>
<br>

# References

- [Windows Supported SSL/TLS Protocols](https://docs.microsoft.com/en-us/windows/win32/secauthn/protocols-in-tls-ssl--schannel-ssp-)
- [Enabling/Disabling SSL/TLS Protocols](https://docs.microsoft.com/en-us/windows-server/identity/ad-fs/operations/manage-ssl-protocols-in-ad-fs)
