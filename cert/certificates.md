# Creating a Certificate Signing Request (CSR) using OpenSSL

Windows stores CSR and the corresponding private keys in Certificate Store. However, OpenSSL generates a CSR file and separate file with unencrypted private key. Once the certificate has been generated, the problem occurs when you try to import this certificate to the Windows certificate store. Obviously it will be imported without the private key because Certificate Import Wizard don't know anything about the separate private key file.

```bash
openssl req -new -newkey rsa:2048 -nodes -keyout private.key -out certificate.csr
```

# Merge Certificate and Private Key to a PKCS#12(PFX) file
## Using OpenSSL
```bash
openssl pkcs12 –export –in certificate.cer –inkey private.key –out certificate.pfx
```

## Using CertUtil
```cmd
certutil –MergePFX certificate.cer certificate.pfx
```
Since there is no way to specify private key file for –MergePFX parameter you must consider the following requirements:

- Private key file MUST have .KEY extension
- Certificate and private key files MUST have the same base file name (file name excluding extension)
- Certificate and private key file must be placed in the same directory

# Convert PFX to PEM
```bash
openssl pkcs12 -in certificate.pfx -out certificate.cer -nodes
```
