# Creating a Certificate Signing Request (CSR) using OpenSSL

Windows stores CSR and the corresponding private keys in Certificate Store. However, OpenSSL generates a CSR file and separate file with unencrypted private key. Once the certificate has been generated, the problem occurs when you try to import this certificate to the Windows certificate store. Obviously it will be imported without the private key because Certificate Import Wizard don't know anything about the separate private key file.

```bash
openssl req -new -newkey rsa:2048 -nodes -keyout server.key -out server.csr
```

# Merge Certificate and Private Key to a PKCS#12(PFX) file
## Using OpenSSL
```bash
pkcs12 –export –in certfile.cer –inkey certfile.key –out certfile.pfx
```

## Using CertUtil
```cmd
certutil –MergePFX certfile.cer certfile.pfx
```
Since there is no way to specify private key file for –MergePFX parameter you must consider the following requirements:

- Private key file MUST have .KEY extension
- Certificate and private key files MUST have the same base file name (file name excluding extension)
- Certificate and private key file must be placed in the same directory
